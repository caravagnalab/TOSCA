# TOSCA

TOSCA is a packege for inferring the timing in real time of clonal and
subclonal somatic copy numbers (SCNA) of type 2:0, 2:1 and 2:2, and of
driver events altering the mutation rate. The input data is the result
of the clonal and signature deconvolution analyses performed on WGS
longitudinal data.

#### Citation

If you use `TOSCA`, please cite: \* *Timing cancer genomics driver
events around therapy* Riccardo Bergamin, Alice Antonello, Giulio
Caravagna.

#### Help and support

[![](https://img.shields.io/badge/GitHub%20Pages-https://caravagnalab.github.io/TOSCA/-yellow.svg)](https://caravagnalab.github.io/TOSCA)

## Installation

``` r
devtools::install_github("caravagnalab/TOSCA")
```

# Package index

## Available data

Datasets included in the package.

- [`exampleData_CNA_dormancy`](https://caravagnalab.github.io/TOSCA/reference/exampleData_CNA_dormancy.md)
  : Dataset with a toy example for the CNA model with dormancy
- [`exampleData_CNA`](https://caravagnalab.github.io/TOSCA/reference/exampleData_CNA.md)
  : Dataset with a toy example for the CNA model
- [`exampleData_Driver`](https://caravagnalab.github.io/TOSCA/reference/exampleData_Driver.md)
  : Dataset with a toy example for the Driver model
- [`exampleFit`](https://caravagnalab.github.io/TOSCA/reference/exampleFit.md)
  : Example of a TOSCA object with compleated inference

## Create TOSCA object

Functions to create the TOSCA object and check the format of input data.

- [`init()`](https://caravagnalab.github.io/TOSCA/reference/init.md) :
  Initialise TOSCA object

- [`check_clinical_input()`](https://caravagnalab.github.io/TOSCA/reference/check_clinical_input.md)
  : Check clinical input

- [`check_genomic_input()`](https://caravagnalab.github.io/TOSCA/reference/check_genomic_input.md)
  : Check that the input mutation dataframe is valid

- [`check_parameters_input()`](https://caravagnalab.github.io/TOSCA/reference/check_parameters_input.md)
  : Checks that the parameters dataframe is valid

- [`check_required_cols()`](https://caravagnalab.github.io/TOSCA/reference/check_required_cols.md)
  : Check that for the required columns for each dataframe are present

- [`check_valid_date()`](https://caravagnalab.github.io/TOSCA/reference/check_valid_date.md)
  : Check that the input date is valid

- [`check_valid_karyotype()`](https://caravagnalab.github.io/TOSCA/reference/check_valid_karyotype.md)
  : Check that the input karytypes in the mutations dataframe are valid

- [`convert_date_real()`](https://caravagnalab.github.io/TOSCA/reference/convert_date_real.md)
  : Converts real into date

- [`convert_real_date()`](https://caravagnalab.github.io/TOSCA/reference/convert_real_date.md)
  : Converts date into real

- [`print(`*`<TOSCA>`*`)`](https://caravagnalab.github.io/TOSCA/reference/print.TOSCA.md)
  :

  Print for class `'TOSCA'`.

## Fit model

Function to fit model.

- [`fit()`](https://caravagnalab.github.io/TOSCA/reference/fit.md) :
  Infer the timing of the events of interest fitting the appropriate
  TOSCA model

## Plot fit

Function to visualise the results of the fit.

- [`check_ppc()`](https://caravagnalab.github.io/TOSCA/reference/check_ppc.md)
  : Posterior Predictive checks
- [`plot_expected_N()`](https://caravagnalab.github.io/TOSCA/reference/plot_expected_N.md)
  : Posterior distribution of the number of cells collected in the first
  and second samples.
- [`plot_ppc()`](https://caravagnalab.github.io/TOSCA/reference/plot_ppc.md)
  : Plot posterior predictive checks
- [`plot_ppc_single_mut()`](https://caravagnalab.github.io/TOSCA/reference/plot_ppc_single_mut.md)
  : Plot the posterior predictive distribution and compares it to the
  real number of mutations
- [`get_name_mu_step()`](https://caravagnalab.github.io/TOSCA/reference/get_name_mu_step.md)
  : Title
- [`plot_prior_vs_posterior()`](https://caravagnalab.github.io/TOSCA/reference/plot_prior_vs_posterior.md)
  : Produce collective plot of prior vs posterior for all inferred
  parameters
- [`plot_prior_vs_posterior_single_parameter()`](https://caravagnalab.github.io/TOSCA/reference/plot_prior_vs_posterior_single_parameter.md)
  : Prior vs Posterior distribution of inferred parameter
- [`plot_timing()`](https://caravagnalab.github.io/TOSCA/reference/plot_timing.md)
  : Plot clinical timeline + posterior times with histogram
- [`plot_timing_MAP()`](https://caravagnalab.github.io/TOSCA/reference/plot_timing_MAP.md)
  : Plot clinical timeline + posterior times with MAP
- [`days_from()`](https://caravagnalab.github.io/TOSCA/reference/days_from.md)
  : Computes the days of the event of interest from a date of interest

## Examine fit

Get the results from the inference.

- [`get_fit_summary()`](https://caravagnalab.github.io/TOSCA/reference/get_fit_summary.md)
  : Get mean, mode and q5, q95
- [`get_index_from_drug_name()`](https://caravagnalab.github.io/TOSCA/reference/get_index_from_drug_name.md)
  : Get index from drug name
- [`get_index_from_cna_length()`](https://caravagnalab.github.io/TOSCA/reference/get_index_from_cna_length.md)
  : Get index from cna_length

